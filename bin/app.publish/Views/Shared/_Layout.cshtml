<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>MZD Portal</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href='~/Content/boxicons.min.css' rel='stylesheet'>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/popper")
    <link rel="stylesheet" href="~/Content/my.css" />
    <link rel="stylesheet" href="~/Content/Loading.css" />

    <script src="~/Scripts/chart.js"></script>
    <script src="~/Scripts/json2.min.js"></script>
    <script src="~/Scripts/jquery.min.js"></script>
    <style>
        html, body {
            height: 100%;
            overflow: auto;
        }

        nav.sidebar {
            width: 285px; /* Sidebar genişliği */
        }

        .nav-link.dropdown .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%; /* Dropdown menüsünü altına yerleştirir */
            left: 0;
            z-index: 1000;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 10px;
            border-radius: 5px;
        }

        .nav-link.dropdown .dropdown-menu.show {
            display: block;
        }

        .bottom-content .nav-link.dropdown .dropdown-menu {
            top: auto;
            bottom: 100%; /* Dropdown menüsünü yukarı doğru açılacak şekilde yerleştirir */
        }

        .main-content {
            margin-left: 285px; /* Sidebar genişliği kadar boşluk bırak */
            padding: 20px;
            min-width: calc(100% - 285px); /* Sidebar genişliğini hesaba kat */
            min-height: 100vh;
        }

        .modal-dialog {
            max-width: 80%; /* Modal genişliğini ayarla */
            max-height: 80%; /* Modal yüksekliğini ayarla */
        }

        .modal-content {
            overflow: auto; /* İçeriğin taşmasını engelle */
        }

        .modal-body {
            max-height: 60vh; /* İçeriğin yüksekliğini sınırlamak için */
            overflow-y: auto; /* Dikey kaydırma çubuğu ekle */
            word-wrap: break-word; /* Uzun kelimelerin taşmasını engelle */
        }

        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            z-index: 1049;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .loadingMessage {
            font-size: 24px;
            color: #000;
        }
        .toggle-box {
            font-size: 16px;
            position: fixed;
            bottom: 20px;
            right: 10px;
            width: 500px;
            max-height: 60vh; /* İçeriğin yüksekliğini sınırlamak için */
            border: 1px solid #ccc;
            padding: 10px;
            padding-top:35px;
            border-radius: 5px;
            background-color: white;
            display: none;
            overflow-y: auto; /* Dikey kaydırma çubuğu ekle */
            scroll-behavior: smooth; /* Otomatik kaydırma için */
            word-wrap: break-word; /* Uzun kelimelerin taşmasını engelle */
        }

        .toggle-button {
            position: fixed;
            bottom: 10px;
            right: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }

        .online-user {
            display: flex;
            align-items: center;
        }

            .online-user::before {
                content: '•';
                color: green;
                margin-right: 5px;
            }

        .btn-custom {
            all: unset; /* Tüm CSS özelliklerini sıfırla */
            background-color: #28a745; /* Yeşil arka plan rengi */
            color: white; /* Beyaz yazı rengi */
            border: none; /* Kenarlık yok */
            padding: 5px; /* İç boşluk */
            border-radius: 5px; /* Köşe yuvarlama */
            cursor: pointer; /* İmleç değişimi */
            transition: background-color 0.3s; /* Geçiş efekti */
        }

            .btn-custom:hover {
                background-color: #218838; /* Hover durumunda daha koyu yeşil */
            }

        #messages div {
            background-color: #f1f1f1;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            border: 1px solid #ccc;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

            #messages div strong {
                color: #007bff;
                font-weight: bold;
            }

            #messages div em {
                color: #888;
                font-style: italic;
            }

            #messages div.user-message {
                text-align: right;
                background-color: #d1e7dd;
            }

        #notificationCount {
            color: red;
            font-size: 14px;
            position: relative;
            font-weight: bold;
            margin-left: 5px;
        }
    </style>
</head>

<body>
    <nav class="sidebar">
        <header>

            <div class="image-text">
                <span class="image">
                    <img src="~/imgs/logo.png" alt="">
                </span>

            </div>
            <div class="text logo-text">
            </div>
        </header>

        <div class="menu-bar">
            <div class="menu">
                <ul class="menu-links">
                    <li class="nav-link">
                        <a href="@Url.Action("Index", "Home")">
                            <i class='bx bx-home-alt icon'></i>
                            <span class="text nav-text">Anasayfa</span>
                        </a>
                    </li>
                    <li class="nav-link">
                        <a href="@Url.Action("Index", "Contact")">
                            <i class='bx bxs-contact icon'></i>
                            <span class="text nav-text">Rehber</span>
                        </a>
                    </li>
                    @if (User.IsInRole("IK") || User.IsInRole("Yonetici") || User.IsInRole("Sys"))
                    {
                        <li class="nav-link dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class='bx bx-street-view icon'></i>
                                <span class="text nav-text">İnsan Kaynakları</span>
                            </a>
                            <ul class="dropdown-menu menu-links">
                                <li class="nav-link"><a href="@Url.Action("DilekIstek_IK", "InsanKaynaklari")">Dilek Kutusu</a></li>
                                <li class="nav-link"><a href="@Url.Action("GonderiOlustur", "Gonderi")">Duyuru Oluştur</a></li>
                                <li class="nav-link"><a href="@Url.Action("GonderiListele", "Gonderi")">Duyuru Listele</a></li>
                                <li class="nav-link"><a href="@Url.Action("SendNotification", "Notification")">Anlık Bildirim</a></li>

                            </ul>
                        </li>
                    }

                    @if (User.IsInRole("BilgiIslem") || User.IsInRole("Yonetici") || User.IsInRole("Sys"))
                    {
                        <li class="nav-link dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class='bx bx-signal-5 icon'></i>
                                <span class="text nav-text">Bilgi İşlem</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="@Url.Action("Index", "Kullanici_Islemleri")">Kullanıcı İşlemleri</a></li>
                                <li><a href="@Url.Action("YemekYukle", "BilgiIslem")">Yemek Yükle/Sil</a></li>
                                <li><a href="@Url.Action("MolaYukle", "BilgiIslem")">Mola Yükle/Sil</a></li>
                                <li><a href="@Url.Action("SendNotification", "Notification")">Anlık Bildirim</a></li>
                            </ul>
                        </li>
                    }

                    @if (User.IsInRole("IdariIsler") || User.IsInRole("Yonetici") || User.IsInRole("Sys"))
                    {
                        <li class="nav-link dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class='bx bx-street-view icon'></i>
                                <span class="text nav-text">İdari İşler</span>
                            </a>
                            <ul class="dropdown-menu menu-links">
                                <li class="nav-link"><a href="@Url.Action("DilekIstek_IK", "InsanKaynaklari")">Dilek Kutusu</a></li>
                                <li class="nav-link"><a href="@Url.Action("GonderiOlustur", "Gonderi")">Duyuru Oluştur</a></li>
                                <li class="nav-link"><a href="@Url.Action("GonderiListele", "Gonderi")">Duyuru Listele</a></li>
                                <li class="nav-link"><a href="@Url.Action("SendNotification", "Notification")">Anlık Bildirim</a></li>
                            </ul>
                        </li>
                    }
                    @if (User.IsInRole("Dokumantasyon") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("Merkez") || User.IsInRole("Yerleske") || User.IsInRole("Lider"))
                    {
                        <li class="nav-link dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class='bx bx-book-open icon'></i>
                                <span class="text nav-text">Dokümantasyon</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="@Url.Action("Index", "Dokumantasyon")">Stok Kartı</a></li>
                                @if (User.IsInRole("Dokumantasyon") || User.IsInRole("Yonetici") || User.IsInRole("Sys"))
                                {
                                    <li><a href="@Url.Action("Index_sorumlu", "Dokumantasyon")">Gelen Talepler</a></li>
                                }
                            </ul>
                        </li>
                    }
                    @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("Dokumantasyon") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler") || User.IsInRole("Merkez") || User.IsInRole("Yerleske"))
                    {
                        <li class="nav-link">
                            <a href="@Url.Action("Create", "DilekOneri")">
                                <i class='bx bx-envelope icon'></i>
                                <span class="text nav-text">Dilek & Öneri</span>
                            </a>
                        </li>
                    }
                    @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("Dokumantasyon") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler") || User.IsInRole("Merkez") || User.IsInRole("Yerleske"))
                    {
                        <li class="nav-link">
                            <a href="@Url.Action("Index", "Survey")">
                                <i class='bx bx-edit icon'></i>
                                <span class="text nav-text">Anketler</span>
                            </a>
                        </li>
                    }
                    @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("Dokumantasyon") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler") || User.IsInRole("Merkez"))
                    {
                        <li class="nav-link">
                            <a href="@Url.Action("MerkezYemekListesi", "Home")">
                                <i class='bx bx-food-menu icon'></i>
                                <span class="text nav-text">Merkez Yemek Listesi</span>
                            </a>
                        </li>
                    }
                    @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("Dokumantasyon") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler") || User.IsInRole("Yerleske"))
                    {
                        <li class="nav-link">
                            <a href="@Url.Action("YerleskeYemekListesi", "Home")">
                                <i class='bx bx-food-menu icon'></i>
                                <span class="text nav-text">Yerleşke Yemek Listesi</span>
                            </a>
                        </li>
                    }
                    <li class="nav-link">
                        <a href="@Url.Action("Mola", "Home")">
                            <i class='bx bx-time icon'></i>
                            <span class="text nav-text">Mola Saatleri</span>
                        </a>
                    </li>
                    @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler") || User.IsInRole("Yerleske") || User.IsInRole("Merkez") || User.IsInRole("Dokumantasyon"))
                    {
                        <li class="nav-link dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class='bx bx-user icon'></i>
                                <span class="text nav-text">Görev</span>
                            </a>
                            <ul class="dropdown-menu">
                                @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler"))
                                {
                                    <li><a href="@Url.Action("Index", "Task")">Görev Atama</a></li>
                                }

                                <li><a href="@Url.Action("UserTasks", "Task")">Görevlerim</a></li>
                            </ul>
                        </li>
                    }
                </ul>
            </div>

            <div class="bottom-content">
                <div id="onlineUsers" style="font-size:12px; top: 10px; right: 10px; background-color: white; padding: 10px; border-radius: 5px;">
                    Çevrimiçi Kullanıcılar: <span id="onlineUsersCount"></span>
                </div>
                @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("Dokumantasyon") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler") || User.IsInRole("Merkez") || User.IsInRole("Yerleske"))
                {
                    <li class="nav-link dropdown">
                        <a class="dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class='bx bxs-inbox icon'></i> <span class="text nav-text">Gelen Kutusu</span>
                            <!--<span id="notificationCount"></span>-->
                            <i id="notificationIcon" class="bx bxs-bell-ring bx-tada" style="display: none; color:gray; margin-left:5px;"></i>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown" id="notificationList">
                            <span class="text nav-text">Hiç Bildirim Yok</span>
                        </div>
                    </li>

                    <li class="nav-link dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class='bx bx-user icon'></i>
                            <span class="text nav-text">Profilim</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="@Url.Action("Edit", "User")">Profil Detayları</a></li>
                            <li><a href="@Url.Action("Bildirimlerim", "DilekOneri")">Dilek ve Öneri Kutum</a></li>
                        </ul>
                    </li>
                }
                <li class="nav-link">
                    @if (User.Identity.IsAuthenticated)
                    {
                        <a href="@Url.Action("Logout", "Account")">
                            <i class='bx bx-log-out icon'></i>
                            <span class="text nav-text">Çıkış yap</span>
                        </a>
                    }
                    else
                    {
                        <a href="@Url.Action("Login", "Account")">
                            <i class='bx bx-log-in icon'></i>
                            <span class="text nav-text">Giriş yap</span>
                        </a>
                    }
                </li>
            </div>
        </div>
    </nav>
    <div class="main-content">

        <div id="loadingOverlay" style="display: none;">
            <div class="logo-container">
                <img src="~/imgs/loader.png" alt="Logo" class="animated-logo" />
                <div class="loader"></div>
            </div>
        </div>

        @RenderBody()
    </div>

    <div id="toggleBox" class="toggle-box">
        <button id="closeButton" class="btn-close" style="position: absolute; top: 10px; right: 7px;"></button>
        <div id="messages" style="max-height: 200px; overflow-y: auto;"></div>
        <input type="text" id="messageInput" placeholder="Mesajınızı yazın..." style="min-width:80%;" />
        <button id="sendButton" class="btn-custom">Gönder</button>
        <div id="onlineUsersListContainer" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
            <ul id="onlineUsersList" style="list-style: none; padding: 0; display: flex; flex-wrap: wrap; gap: 10px;"></ul>
        </div>
    </div>
    <button id="toggleButton" class="toggle-button" style="background-color: #28a745;">Chat Aç/Kapa</button>



    <div class="modal" id="notificationModal" tabindex="-1" role="dialog" aria-labelledby="notificationModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="notificationModalLabel">Bildirim</h5>
                </div>
                <div class="modal-body">
                    <p id="notificationMessage"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close" data-dismiss="modal">Kapat</button>
                </div>
            </div>
        </div>
    </div>

    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/popper")
    @RenderSection("scripts", required: false)

    <script src="~/Scripts/jquery-2.2.4.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
    <script src="~/signalr/hubs"></script>


    <script>
    $(document).ready(function () {
        $('#toggleButton').click(function () {
            $('#toggleBox').toggle();
            $(this).css('display', $('#toggleBox').is(':visible') ? 'none' : 'block');
        });

        $('#closeButton').click(function () {
            $('#toggleBox').hide();
            $('#toggleButton').show();
        });

        $('#messageInput').keypress(function (e) {
            if (e.which == 13) {
                $('#sendButton').click();
                return false;
            }
        });

        @if (User.IsInRole("Lider") || User.IsInRole("Yonetici") || User.IsInRole("Sys") || User.IsInRole("IK") || User.IsInRole("BilgiIslem") || User.IsInRole("IdariIsler"))
        {
            <text>
            initializeChatHub();
            </text>
        }

        initializeNotificationHub();
        initializeOnlineUsersHub();
        initializeSidebar();
        initializeModeSwitch();
        initializeActiveMenu();
        initializeDropdownMenus();
        initializeLoadingOverlay();
        scrollToBottom();
    });

    function initializeChatHub() {
    var chat = $.connection.chatHub;
    var notificationSound = new Audio('@Url.Content("~/Content/notification.mp3")');

    chat.client.broadcastMessage = function (user, message) {
        var timestamp = new Date().toLocaleTimeString();
        $('#messages').append('<div><strong>' + user + '</strong> (' + timestamp + '): ' + message + '</div>');
        scrollToBottom();
        notificationSound.play();
    };

    // Kullanıcı giriş/çıkış mesajlarını kaldırdık
    // chat.client.userConnected = function (user, users) {
    //     $('#messages').append('<div><em>' + user + ' katıldı</em></div>');
    //     scrollToBottom();
    //     updateUsersList(users);
    // };

    // chat.client.userDisconnected = function (user, users) {
    //     $('#messages').append('<div><em>' + user + ' ayrıldı</em></div>');
    //     scrollToBottom();
    //     updateUsersList(users);
    // };

    $('#sendButton').click(function () {
        var message = $('#messageInput').val();
        chat.server.send('@User.Identity.Name', message);
        $('#messageInput').val('').focus();
    });

    $.connection.hub.start().done(function () {
        console.log('SignalR bağlantısı kuruldu. (_ChatHub)');
    }).fail(function (error) {
        console.error('SignalR bağlantısı kurulamadı: ' + error);
    });
}


        function initializeOnlineUsersHub() {
            var onlineUsersHub = $.connection.onlineUsersHub;

            // Kullanıcı sayısı güncellendiğinde tetiklenir
            onlineUsersHub.client.updateOnlineUsers = function (count) {
                document.getElementById('onlineUsersCount').innerText = count;
            };

            // Kullanıcı listesi güncellendiğinde tetiklenir
            onlineUsersHub.client.updateUserList = function (users) {
                updateUsersList(users);
            };

            // SignalR bağlantısını başlat
            $.connection.hub.start().done(function () {
                console.log("SignalR bağlantısı kuruldu.(_OnlineUsersHub)");
            }).fail(function (error) {
                console.error('SignalR bağlantısı kurulamadı: ' + error);
            });
        }

        // Kullanıcı listesini güncelle
        function updateUsersList(users) {
            var usersList = $('#onlineUsersList');
            usersList.empty();
            users.forEach(function (user) {
                usersList.append('<li class="online-user">' + user + '</li>');
            });
        }

    function scrollToBottom() {
        var messagesContainer = $('#messages');
        messagesContainer.scrollTop(messagesContainer[0].scrollHeight);
    }

    function initializeSidebar() {
        const body = document.querySelector('body'),
            sidebar = body.querySelector('nav'),
            searchBtn = body.querySelector(".search-box");

        if (searchBtn) {
            searchBtn.addEventListener("click", () => {
                sidebar.classList.remove("close");
            });
        }
    }

    function initializeModeSwitch() {
        const body = document.querySelector('body'),
            modeSwitch = body.querySelector(".toggle-switch"),
            modeText = body.querySelector(".mode-text");

        if (modeSwitch) {
            modeSwitch.addEventListener("click", () => {
                body.classList.toggle("dark");
                modeText.innerText = body.classList.contains("dark") ? "Light mode" : "Dark mode";
            });
        }
    }

    function initializeActiveMenu() {
        $('.nav-link a').on('click', function () {
            $('.nav-link').removeClass('active');
            $(this).parent().addClass('active');
        });
    }

    function initializeDropdownMenus() {
        $('.nav-link.dropdown > a').on('click', function (e) {
            e.preventDefault();
            const dropdownMenu = $(this).siblings('.dropdown-menu');

            if (dropdownMenu.hasClass('show')) {
                dropdownMenu.removeClass('show').slideUp(200);
            } else {
                dropdownMenu.addClass('show').slideDown(200);
            }
        });

        $('.nav-link.dropdown').on('mouseleave', function () {
            const dropdownMenu = $(this).find('.dropdown-menu');
            if (dropdownMenu.hasClass('show')) {
                dropdownMenu.removeClass('show').slideUp(200);
            }
        });

        $('.dropdown-menu').on('mouseleave', function () {
            $(this).removeClass('show').slideUp(200);
        });
    }

    function initializeNotificationHub() {
        var notificationHub = $.connection.notificationHub;

        notificationHub.client.showNotification = function (message) {
            document.getElementById('notificationMessage').innerHTML = message;
            var modal = document.getElementById('notificationModal');
            modal.style.display = "block";
        };

        $('#sendNotification').click(function () {
            var message = tinymce.get('message').getContent();
            notificationHub.server.sendNotification(message);
        });

        $.connection.hub.start().done(function () {
            console.log("SignalR bağlantısı kuruldu.(_NotificationHub)");
        });

        var span = document.getElementsByClassName("close")[0];
        span.onclick = function () {
            var modal = document.getElementById('notificationModal');
            modal.style.display = "none";
        };
    }

    function initializeLoadingOverlay() {
        $('#loadingOverlay').hide();

        $('a').on('click', function (e) {
            if (!$(this).hasClass('dropdown-toggle')) {
                $('#loadingOverlay').show();
            }
        });
        }




$(document).ready(function () {
    function updateNotifications() {
        $.get('@Url.Action("GetUnreadNotifications", "Notification")', function (data) {
            var notificationList = $('#notificationList');
            var notificationCount = $('#notificationCount');
            var notificationIcon = $('#notificationIcon');
            notificationList.empty();
            if (data.length > 0) {
                notificationCount.text(data.length);
                notificationIcon.css('display', 'inline'); // Burada display stilini inline olarak ayarlıyoruz
                data.forEach(function (notification) {
                    notificationList.append('<a href="#" class="notification-link" data-id="' + notification.Id + '">' + notification.Message + '</a>');
                });
            } else {
                notificationCount.text('');
                notificationIcon.css('display', 'none'); // Burada display stilini none olarak ayarlıyoruz
                notificationList.append('<span class="text nav-text">Hiç Bildirim Yok</span>');
            }
        });
    }

    updateNotifications();
    setInterval(updateNotifications, 60000); // 60 saniyede bir bildirimleri kontrol et

    $(document).on('click', '.notification-link', function (e) {
        e.preventDefault();
        var id = $(this).data('id');
        $.post('@Url.Action("MarkAsRead", "Notification")', { id: id }, function (data) {
            if (data.success) {
                updateNotifications();
            }
        });
    });
});

 function GetNotificationUrl(notification) {
     if (notification.Message.includes("anket")) {
         return '@Url.Action("Index", "Survey")';
     } else if (notification.Message.includes("görev")) {
         return '@Url.Action("UserTasks", "Task")';
     }
     else if (notification.Message.includes("Dilek")) {
         return '@Url.Action("Bildirimlerim", "DilekOneri")';
     }
     else {
         return '#';
     }
 }

 $(document).on('click', '.notification-link', function (e) {
     e.preventDefault();
     var id = $(this).data('id');
     var url = GetNotificationUrl({ Message: $(this).text() });
     $.post('@Url.Action("MarkAsRead", "Notification")', { id: id }, function (data) {
         if (data.success) {
             window.location.href = url;
         }
     });
 });




    </script>

</body>

</html>
