@model IEnumerable<MZDNETWORK.Models.LateArrivalReport>
@{
    Layout = null;
    var header = ViewBag.Header as MZDNETWORK.Models.LateArrivalReportHeader;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>İşe Geç Gelme Tutanakları</title>
    <style>
        body{font-family:Arial,Helvetica,sans-serif}
        table{border-collapse:collapse;width:100%}
        th,td{border:1px solid #000;padding:4px;font-size:12px;text-align:left}
        .no-print{display:none}
    </style>
</head>
<body>
    <div style="display:flex;align-items:center;justify-content:space-between">
        <img src="/imgs/logo_form.png" style="height:80px" />
        <div style="font-size:24px;font-weight:bold;text-align:center">İşe Geç Gelme Tutanakları</div>
        <div style="font-size:12px;text-align:right">
            @if(header!=null){
                <div>@header.PrintableNote</div>
                <div>Doküman No : @header.DocumentNo</div>
                <div>İlk Yayın   : @header.FirstPublishDate.ToString("dd.MM.yyyy")</div>
                <div>Revizyon T.: @header.RevisionDate.ToString("dd.MM.yyyy")</div>
                <div>Revizyon No: @header.RevisionNo</div>
            }
        </div>
    </div>
    <hr />
    <table>
        <thead>
            <tr>
                <th>Sıra</th><th>Tarih</th><th>Ad Soyad</th><th>Birim</th><th>Ünvan</th><th>Başlangıç</th><th>Gerçek Başlangıç</th><th>Savunma</th><th>İmza</th>
            </tr>
        </thead>
        <tbody>
            @{int i=1;}
            @foreach(var item in Model){
                <tr>
                    <td>@i</td>
                    <td>@item.LateDate.ToString("dd.MM.yyyy")</td>
                    <td>@item.FullName</td>
                    <td>@item.Department</td>
                    <td>@item.Title</td>
                    <td>@item.ShiftStartTime.ToString("hh\\:mm")</td>
                    <td>@item.ArrivalTime.ToString("hh\\:mm")</td>
                    <td>@item.DefenseText</td>
                    <td>
                        @if(!string.IsNullOrEmpty(item.SignaturePath)){
                            <img src="@item.SignaturePath" style="height:40px" />
                        }
                    </td>
                </tr>
                i++;
            }
        </tbody>
    </table>
    <script>window.onload=function(){window.print();};</script>
</body>
</html> 