@model IEnumerable<MZDNETWORK.Models.VisitorEntry>
@{
    Layout = null;
    var header = ViewBag.Header as MZDNETWORK.Models.VisitorEntryHeader;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Ziyaretçi Formu</title>
    <style>
        body{font-family:Arial,Helvetica,sans-serif}
        table{border-collapse:collapse;width:100%}
        th,td{border:1px solid #000;padding:4px;font-size:12px;text-align:left}
        .no-print{display:none}
    </style>
</head>
<body>
    <div style="display:flex;align-items:center;justify-content:space-between">
        <img src="/imgs/logo_form.png" style="height:80px" />
        <div style="font-size:34px; font-weight:bold; text-align:center">Ziyaretçi Kayıtları</div>
        <div style="font-size:12px">
            @if(header!=null){
                <div>@header.PrintableNote</div>
                <div>Doküman No : @header.DocumentNo</div>
                <div>İlk Yayın   : @header.FirstPublishDate.ToString("dd.MM.yyyy")</div>
                <div>Revizyon T.: @header.RevisionDate.ToString("dd.MM.yyyy")</div>
                <div>Revizyon No: @header.RevisionNo</div>
            }
        </div>
    </div>
    <hr />
    <table>
        <thead>
            <tr>
                <th>Sıra</th><th>Tarih</th><th>Ad Soyad</th><th>Geliş Sebebi</th><th>Firma</th><th>Görevi</th><th>Kimlik No</th><th>TC Kimlik</th><th>Giriş</th><th>Çıkış</th><th>İmza</th>
            </tr>
        </thead>
        <tbody>
            @{int i = 1;}
            @foreach (var item in Model)
            {
                <tr>
                    <td>@i</td>
                    <td>@item.Date.ToString("dd.MM.yyyy")</td>
                    <td>@item.FullName</td>
                    <td>@item.ArrivalReason</td>
                    <td>@item.Organization</td>
                    <td>@item.Duty</td>
                    <td>@item.IdentityNo</td>
                    <td>@item.TCKimlik</td>
                    <td>@(item.EntryTime.ToString(@"hh\:mm"))</td>
                    <td>@(item.ExitTime?.ToString(@"hh\:mm"))</td>
                    <td>
                        @if(!string.IsNullOrEmpty(item.SignaturePath)){
                            <img src="@item.SignaturePath" style="height:40px" />
                        }
                    </td>
                </tr>
                i++;
            }
        </tbody>
    </table>
    <script>
        window.onload = function(){ window.print(); };
    </script>
</body>
</html>